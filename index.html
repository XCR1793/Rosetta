<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; connect-src 'self' https://api.exchangerate-api.com https://open.er-api.com">
  <title>Rosetta</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-container">
    <!-- Title bar (draggable) -->
    <div class="title-bar">
      <span class="title-text">Rosetta</span>
      <button class="settings-btn" id="settingsBtn" title="Settings">
        <svg viewBox="0 0 24 24" width="16" height="16">
          <path fill="currentColor" d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z"/>
        </svg>
      </button>
      <button class="theme-btn" id="themeBtn" title="Theme">
        <svg viewBox="0 0 24 24" width="16" height="16">
          <path fill="currentColor" d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
        </svg>
      </button>
      <button class="sync-btn" id="syncBtn" title="Sync Timelines">
        <svg viewBox="0 0 24 24" width="16" height="16">
          <path fill="currentColor" d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
        </svg>
      </button>
      <button class="time-format-btn" id="timeFormatBtn" title="Toggle 12h/24h">12h</button>
      <button class="converter-btn" id="converterBtn" title="Unit Converter">
        <svg viewBox="0 0 24 24" width="16" height="16">
          <path fill="currentColor" d="M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"/>
        </svg>
      </button>
      <button class="compact-btn" id="compactBtn" title="Toggle Compact Mode">
        <svg viewBox="0 0 24 24" width="14" height="14">
          <path fill="currentColor" d="M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"/>
        </svg>
      </button>
      <button class="close-btn" id="closeBtn" title="Close">
        <svg viewBox="0 0 24 24" width="14" height="14">
          <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
    </div>

    <!-- Main content -->
    <div class="content">
      <div id="timelinesContainer"></div>
    </div>

    <!-- Converter Panel (hidden by default) -->
    <div class="converter-panel" id="converterPanel">
      <div class="converter-header">
        <h3>Unit Converter</h3>
        <button class="close-converter-btn" id="closeConverterBtn">
          <svg viewBox="0 0 24 24" width="14" height="14">
            <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
      </div>
      <div class="converter-content">
        <div class="converter-type-selector">
          <button class="converter-type-btn active" data-type="temperature">Temp</button>
          <button class="converter-type-btn" data-type="currency">Currency</button>
          <button class="converter-type-btn" data-type="length">Length</button>
          <button class="converter-type-btn" data-type="weight">Weight</button>
        </div>
        <div class="converter-inputs">
          <div class="converter-input-group">
            <select class="converter-from-unit" id="converterFromUnit"></select>
            <input type="number" class="converter-from-value" id="converterFromValue" placeholder="0" step="any">
          </div>
          <div class="converter-swap">
            <button class="swap-btn" id="swapUnitsBtn" title="Swap units">
              <svg viewBox="0 0 24 24" width="18" height="18">
                <path fill="currentColor" d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"/>
              </svg>
            </button>
          </div>
          <div class="converter-input-group">
            <select class="converter-to-unit" id="converterToUnit"></select>
            <input type="number" class="converter-to-value" id="converterToValue" placeholder="0" step="any" readonly>
          </div>
        </div>
        <div class="currency-rate-info" id="currencyRateInfo" style="display: none;">
          <span class="rate-text"></span>
          <span class="rate-updated"></span>
        </div>
      </div>
    </div>

    <!-- Settings Panel (hidden by default) -->
    <div class="settings-panel" id="settingsPanel">
      <div class="settings-header">
        <h3>Settings</h3>
        <button class="close-settings-btn" id="closeSettingsBtn">
          <svg viewBox="0 0 24 24" width="14" height="14">
            <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
      </div>
      <div class="settings-content" id="settingsContent">
        <!-- Timeline settings will be dynamically inserted here -->
      </div>
      <div class="settings-footer">
        <div class="startup-toggle-container">
          <label class="startup-toggle">
            <input type="checkbox" id="startupToggle">
            <span>Launch at Windows startup</span>
          </label>
        </div>
        <button class="add-timeline-btn" id="addTimelineBtn">+ Add Timeline</button>
      </div>
    </div>

    <!-- Theme Panel -->
    <div class="theme-panel" id="themePanel">
      <div class="theme-header">
        <h3>Theme Editor</h3>
        <div class="theme-header-btns">
          <button class="save-theme-btn" id="saveThemeBtn">Save</button>
          <button class="close-theme-btn" id="closeThemeBtn">
            <svg viewBox="0 0 24 24" width="14" height="14">
              <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="theme-content" id="themeContent">
        <!-- Preset selector -->
        <div class="preset-section">
          <span class="preset-label">Presets</span>
          <div class="preset-selector" id="presetSelector">
            <button class="preset-btn active" data-preset="default">Default</button>
            <button class="preset-btn" data-preset="night">Night</button>
            <button class="preset-btn" data-preset="day">Day</button>
            <button class="preset-btn" data-preset="volcano">Volcano</button>
            <button class="preset-btn" data-preset="astral">Astral</button>
            <button class="preset-btn custom" data-preset="custom1">Custom 1</button>
            <button class="preset-btn custom" data-preset="custom2">Custom 2</button>
            <button class="preset-btn custom" data-preset="custom3">Custom 3</button>
          </div>
        </div>

        <!-- Color sections will be generated by JS -->
        <div id="colorSections"></div>
      </div>
    </div>

    <!-- Confirmation Popup -->
    <div class="confirm-popup-overlay" id="confirmPopupOverlay">
      <div class="confirm-popup">
        <div class="confirm-popup-title">Unsaved Changes</div>
        <div class="confirm-popup-message">You have unsaved theme changes. Would you like to save them before closing?</div>
        <div class="confirm-popup-btns">
          <button class="confirm-popup-btn cancel" id="confirmCancel">Cancel</button>
          <button class="confirm-popup-btn discard" id="confirmDiscard">Discard</button>
          <button class="confirm-popup-btn save" id="confirmSave">Save</button>
        </div>
      </div>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
